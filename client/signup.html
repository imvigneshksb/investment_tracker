<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Investment Tracker</title>
    <link rel="stylesheet" href="css/styles.css" />
    <script>
      // Check if user is already logged in and redirect to dashboard
      (async function () {
        try {
          const response = await fetch("/api/auth/verify", {
            credentials: 'include'
          });
          
          if (response.ok) {
            // User is already authenticated, redirect to dashboard
            window.location.href = "dashboard.html";
          }
        } catch (error) {
          // User not authenticated, stay on signup page
          console.log("User not authenticated, showing signup page");
        }
      })();
    </script>
  </head>
  <body>
    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Header -->
    <header class="main-header">
      <div class="header-content">
        <h1 class="logo" onclick="goToHomePage()" tabindex="0">
          Investment Tracker
        </h1>
        <div class="header-profile">
          <div
            class="profile-icon"
            id="profileIcon"
            onclick="toggleProfileMenu()"
            tabindex="0"
            role="button"
            aria-label="User profile menu"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle
                cx="12"
                cy="8"
                r="4"
                stroke="currentColor"
                stroke-width="2"
                fill="none"
              />
              <path
                d="M20 21a8 8 0 1 0-16 0"
                stroke="currentColor"
                stroke-width="2"
                fill="none"
              />
            </svg>
          </div>
          <div class="dropdown" id="profileDropdown" style="display: none">
            <div class="profile-info">
              <div class="profile-name" id="profileName">User Name</div>
              <div class="profile-email" id="profileEmail">user@email.com</div>
            </div>
            <hr class="profile-divider" />
            <div class="profile-menu-item" onclick="showProfileSettings()" tabindex="0" role="menuitem">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"
                  stroke="currentColor"
                  stroke-width="2"
                  fill="none"
                />
                <circle
                  cx="12"
                  cy="12"
                  r="3"
                  stroke="currentColor"
                  stroke-width="2"
                  fill="none"
                />
              </svg>
              Profile Settings
            </div>
            <div class="profile-menu-item" onclick="logout()" tabindex="0" role="menuitem">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"
                  stroke="currentColor"
                  stroke-width="2"
                  fill="none"
                />
                <polyline
                  points="16,17 21,12 16,7"
                  stroke="currentColor"
                  stroke-width="2"
                  fill="none"
                />
                <line
                  x1="21"
                  y1="12"
                  x2="9"
                  y2="12"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Logout
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="single-column-container">
      <!-- Signup Section -->
      <section class="signup-section" id="signupSection">
        <h2 class="section-title">Sign Up</h2>
        <div class="signup-form">
          <div class="input-group">
            <input
              type="text"
              class="input-field"
              placeholder="Full Name *"
              id="fullName"
            />
            <div class="error-message" id="fullNameError"></div>
          </div>

          <div class="input-group">
            <input
              type="email"
              class="input-field"
              placeholder="Email *"
              id="signupEmail"
            />
            <div class="error-message" id="signupEmailError"></div>
          </div>

          <div class="input-group">
            <input
              type="password"
              class="input-field"
              placeholder="Password *"
              id="signupPassword"
            />
            <div class="error-message" id="signupPasswordError"></div>
          </div>

          <div class="input-group">
            <input
              type="password"
              class="input-field"
              placeholder="Confirm Password *"
              id="confirmPassword"
            />
            <div class="error-message" id="confirmPasswordError"></div>
          </div>

          <button class="btn-primary signup-btn" onclick="handleSignup()">
            Sign Up
          </button>
        </div>

        <div class="login-link">
          <p>
            Already have an account?
            <a href="login.html">Login here</a>
          </p>
        </div>
      </section>
    </div>

    <script src="js/script.js"></script>
  </body>
</html>
